<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>東京精密発條株式会社 -品質管理生産技術 </title>
<style>
  :root{
    --bg1:#eef2ff; --bg2:#f8fafc; --card:#fff; --ink:#0f172a; --muted:#64748b; --border:#e5e7eb;
    --accent:#2563eb; --danger:#b91c1c; --shadow:0 30px 60px rgba(15,23,42,.08); --radius:22px;
    --urgent-row:#fee2e2; --urgent-cell:#ef4444;
  }
  *{box-sizing:border-box}
  body{
    margin:0; color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP","Yu Gothic",sans-serif;
    background:
      radial-gradient(1200px 600px at -10% -10%, #c7d2fe 0%, transparent 60%),
      radial-gradient(900px 500px at 110% 0%, #bae6fd 0%, transparent 55%),
      linear-gradient(120deg,var(--bg1),var(--bg2));
    padding-bottom:60px; /* space bawah untuk marquee & footer */
  }
  header{position:sticky;top:0;z-index:10;background:#ffffffcc;backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
  .wrap{max-width:1200px;margin:0 auto;padding:12px 20px}
  .row{display:flex;justify-content:space-between;align-items:center;gap:16px}
  nav a{margin-left:20px;color:var(--accent);font-weight:700;text-decoration:none}
  nav a:hover{text-decoration:underline}
  .controls{display:flex;gap:8px;align-items:center}
  .btn{padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#fff;cursor:pointer}
  .btn[disabled]{opacity:.6;cursor:wait}
  .btn.active{border-color:#93c5fd;background:#f0f9ff}
  .small{font-size:12px;color:var(--muted)}
  main{max-width:1200px;margin:28px auto;padding:0 20px}
  .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;overflow:auto}
  .card-title{display:flex;align-items:center;justify-content:space-between;margin:0 0 10px}
  .subtle{color:#475569;font-size:14px}
  table{width:100%;border-collapse:separate;border-spacing:0;min-width:900px}
  thead th{background:#f8fafc;color:#475569;position:sticky;top:0;z-index:1;text-align:left;font-weight:700;padding:12px 14px;border-bottom:1px solid var(--border)}
  tbody td{padding:12px 14px;border-bottom:1px solid var(--border);white-space:nowrap}
  tbody tr:hover{background:#f1f5ff}

  /* Urgent styles */
  tr.row-urgent td{background:var(--urgent-row)!important;color:#b91c1c;font-weight:600}
  td.cell-urgent{background:var(--urgent-cell)!important;color:#fff!important;font-weight:800!important;border-radius:8px}

  .flag-urgent{display:inline-flex;align-items:center;gap:6px;padding:2px 10px;border-radius:999px;background:#dc2626;color:#fff;font-weight:800;font-size:12px;margin-right:12px}
  .flag-urgent::before{content:"⚠";}

  .badge-done,.badge-todo{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:999px;color:#fff;font-weight:800;font-size:13px;margin-right:12px}
  .badge-done{background:#0ea5e9}
  .badge-todo{background:#94a3b8}

  .chip{display:inline-flex;align-items:center;gap:8px;background:#f1f5f9;border:1px solid var(--border);padding:6px 10px;border-radius:999px}
  .chip strong{font-size:12px;color:#0f172a}
  .chip .count{font-weight:800}

  #urgent-banner{background:#b91c1c;color:#fff;padding:10px 16px;border-radius:10px;margin-bottom:14px;font-weight:bold;text-align:center;animation:blink 1s infinite}
  @keyframes blink{0%,50%,100%{background:#b91c1c}25%,75%{background:#ef4444}}

  .export-bar{margin-bottom:12px;display:flex;gap:8px;justify-content:flex-end}

  /* Filter bar */
  .filterbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:10px 0 0}
  .filterbar input[type="date"]{padding:8px 10px;border:1px solid var(--border);border-radius:10px}

  /* Responsive smartphone */
  @media (max-width: 768px) {
    .row {flex-direction: column; align-items: flex-start;}
    nav {display: flex; flex-wrap: wrap; gap: 10px;}
    table {min-width: unset; font-size: 12px;}
    .card {padding: 12px;}
    .export-bar {justify-content: flex-start; flex-wrap: wrap;}
  }

  /* Marquee */
  .marquee {
    position: fixed;
    bottom: 20px; /* kasih jarak utk footer */
    left: 0; right: 0;
    background: var(--accent);
    color: #fff;
    font-weight: bold;
    padding: 6px 0;
    white-space: nowrap;
    overflow: hidden;
    z-index: 20;
  }
  .marquee span {
    display: inline-block;
    padding-left: 100%;
    animation: marquee 15s linear infinite;
  }
  @keyframes marquee {
    0%   { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }

  /* Footer credit */
  .footer {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    text-align: center;
    font-size: 12px;
    color: var(--muted);
    background: #f1f5f9;
    padding: 4px 0;
    z-index: 21;
  }
</style>
</head>
<body>
<header>
  <div class="wrap row">
    <div style="display:flex;align-items:center;gap:10px">
      <img src="tsh.png" alt="TSH" style="height:36px">
      <strong>品質管理生産技術</strong>
    </div>
    <nav>
      <a href="./index.html"><strong>ホーム</strong></a>
      <a href="./forms.html">出荷検査成績書</a>
      <a href="./sagyoutejunsho.html">検査作業手順書</a>
    </nav>
    <div class="controls">
      <button id="btnRefresh" class="btn" type="button">Refresh now</button>
      <button id="btnLive" class="btn" type="button">Live: Off</button>
      <span id="intervalInfo" class="small">Interval: 60s</span>
    </div>
  </div>
</header>

<main>
  <div id="urgent-banner">現在、至急案件はありません。</div>

  <div style="display:flex;justify-content:space-between;align-items:end">
    <h1>出荷状況一覧</h1>
    <span id="lastUpdated" class="small"></span>
  </div>

  <!-- 本日出荷 -->
  <section id="todaySection" class="card" style="display:none;margin-bottom:20px">
    <div class="card-title">
      <h2 style="margin:0">本日出荷</h2>
      <span class="chip"><strong>件数</strong><span id="todayCount" class="count">0</span></span>
    </div>
    <table id="todayTable">
      <thead><tr id="todayHead"></tr></thead>
      <tbody id="todayBody"></tbody>
    </table>
  </section>

  <section class="card">
    <div class="card-title">
      <h2 style="margin:0">全件一覧</h2>
      <div class="filterbar">
        <label class="subtle">出荷日フィルタ：</label>
        <input type="date" id="filterDate">
        <button class="btn" id="btnToday">本日出荷のみ</button>
        <button class="btn" id="btnClear">Clear</button>
      </div>
    </div>

    <!-- Export bar di atas tabel -->
    <div class="export-bar">
      <button class="btn" id="btnExcel">Export Excel</button>
      <button class="btn" id="btnPDF">Export PDF</button>
    </div>

    <table id="shipTable">
      <thead><tr id="shipHead"></tr></thead>
      <tbody id="shipBody"></tbody>
    </table>
    <div class="muted small" id="shipHint"></div>
  </section>
</main>

<!-- Tulisan berjalan bawah -->
<div class="marquee"><span>東京精密発條株式会社-品質管理生産技術システム</span></div>
<!-- Footer credit -->
<div class="footer">Design by Wahyu</div>

<!-- Export libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

<script>
/* === masukkan kembali seluruh JS load(), renderTable(), filter, export, auto-refresh dsb === */
</script>
</body>
</html>
